services:
  # Base de datos
  db:
    image: postgres:17-alpine
    container_name: happy-balance-db
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: happy_balance
    volumes:
      - ./data/db:/var/lib/postgresql/data
    restart: unless-stopped

  # Backend
  backend:
    image: alcibiadesc/happy-balance-backend:latest
    container_name: happy-balance-backend
    environment:
      DATABASE_URL: postgresql://postgres:postgres@db:5432/happy_balance
      JWT_ACCESS_SECRET: change-this-secret-key
      JWT_REFRESH_SECRET: change-this-refresh-key
      ADMIN_USERNAME: admin
      ADMIN_PASSWORD: admin123  # Cambia esta contrase√±a
    depends_on:
      - db
    ports:
      - 3004:3004
    restart: unless-stopped

  # Frontend
  frontend:
    image: alcibiadesc/happy-balance-frontend:latest
    container_name: happy-balance
    environment:
      VITE_API_URL: http://localhost:3004/api
    depends_on:
      - backend
    ports:
      - 5173:3000
    restart: unless-stopped